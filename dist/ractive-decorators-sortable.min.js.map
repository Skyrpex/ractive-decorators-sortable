{"version":3,"file":"ractive-decorators-sortable.min.js","sources":["../.gobble-build/02-esperantoBundle/1/ractive-decorators-sortable.js"],"sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\tglobal.Ractive.decorators.sortable = factory()\n}(this, function () { 'use strict';\n\n\tvar ractive, sourceKeypath, sourceArray, sourceIndex, dragstartHandler, dragenterHandler, removeTargetClass, preventDefault;\n\n\tvar ractive_decorators_sortable__sortable = function sortable(node) {\n\t\tnode.draggable = true;\n\n\t\tnode.addEventListener('dragstart', dragstartHandler, false);\n\t\tnode.addEventListener('dragenter', dragenterHandler, false);\n\t\tnode.addEventListener('dragleave', removeTargetClass, false);\n\t\tnode.addEventListener('drop', removeTargetClass, false);\n\n\t\t// necessary to prevent animation where ghost element returns\n\t\t// to its (old) home\n\t\tnode.addEventListener('dragover', preventDefault, false);\n\n\t\treturn {\n\t\t\tteardown: function teardown() {\n\t\t\t\tnode.removeEventListener('dragstart', dragstartHandler, false);\n\t\t\t\tnode.removeEventListener('dragenter', dragenterHandler, false);\n\t\t\t\tnode.removeEventListener('dragleave', removeTargetClass, false);\n\t\t\t\tnode.removeEventListener('drop', removeTargetClass, false);\n\t\t\t\tnode.removeEventListener('dragover', preventDefault, false);\n\t\t\t}\n\t\t};\n\t};\n\n\tractive_decorators_sortable__sortable.targetClass = 'droptarget';\n\n\tvar errorMessage = 'The sortable decorator only works with elements that correspond to array members';\n\n\tdragstartHandler = function (event) {\n\t\tvar storage = this._ractive,\n\t\t    lastDotIndex;\n\n\t\tsourceKeypath = storage.keypath.str;\n\n\t\t// this decorator only works with array members!\n\t\tlastDotIndex = sourceKeypath.lastIndexOf('.');\n\n\t\tif (lastDotIndex === -1) {\n\t\t\tthrow new Error(errorMessage);\n\t\t}\n\n\t\tsourceArray = sourceKeypath.substr(0, lastDotIndex);\n\t\tsourceIndex = +sourceKeypath.substring(lastDotIndex + 1);\n\n\t\tif (isNaN(sourceIndex)) {\n\t\t\tthrow new Error(errorMessage);\n\t\t}\n\n\t\tevent.dataTransfer.setData('foo', true); // enables dragging in FF. go figure\n\n\t\t// keep a reference to the Ractive instance that 'owns' this data and this element\n\t\tractive = storage.root;\n\t};\n\n\tdragenterHandler = function () {\n\t\tvar targetKeypath, lastDotIndex, targetArray, targetIndex, array, source;\n\n\t\t// If we strayed into someone else's territory, abort\n\t\tif (this._ractive.root !== ractive) {\n\t\t\treturn;\n\t\t}\n\n\t\ttargetKeypath = this._ractive.keypath.str;\n\n\t\t// this decorator only works with array members!\n\t\tlastDotIndex = targetKeypath.lastIndexOf('.');\n\n\t\tif (lastDotIndex === -1) {\n\t\t\tthrow new Error(errorMessage);\n\t\t}\n\n\t\ttargetArray = targetKeypath.substr(0, lastDotIndex);\n\t\ttargetIndex = +targetKeypath.substring(lastDotIndex + 1);\n\n\t\t// if we're dealing with a different array, abort\n\t\tif (targetArray !== sourceArray) {\n\t\t\treturn;\n\t\t}\n\n\t\t// if it's the same index, add droptarget class then abort\n\t\tif (targetIndex === sourceIndex) {\n\t\t\tthis.classList.add(ractive_decorators_sortable__sortable.targetClass);\n\t\t\treturn;\n\t\t}\n\n\t\tarray = ractive.get(sourceArray);\n\n\t\t// remove source from array\n\t\tsource = array.splice(sourceIndex, 1)[0];\n\n\t\t// the target index is now the source index...\n\t\tsourceIndex = targetIndex;\n\n\t\t// add source back to array in new location\n\t\tarray.splice(sourceIndex, 0, source);\n\t};\n\n\tremoveTargetClass = function () {\n\t\tthis.classList.remove(ractive_decorators_sortable__sortable.targetClass);\n\t};\n\n\tpreventDefault = function (event) {\n\t\tevent.preventDefault();\n\t};\n\n\tvar ractive_decorators_sortable = ractive_decorators_sortable__sortable;\n\n\treturn ractive_decorators_sortable;\n\n}));"],"names":["global","factory","exports","module","define","amd","Ractive","decorators","sortable","this","ractive","sourceKeypath","sourceArray","sourceIndex","dragstartHandler","dragenterHandler","removeTargetClass","preventDefault","ractive_decorators_sortable__sortable","node","draggable","addEventListener","teardown","removeEventListener","targetClass","errorMessage","event","lastDotIndex","storage","_ractive","keypath","str","lastIndexOf","Error","substr","substring","isNaN","dataTransfer","setData","root","targetKeypath","targetArray","targetIndex","array","source","classList","add","get","splice","remove","ractive_decorators_sortable"],"mappings":"CAAC,SAAUA,EAAQC,GACC,gBAAZC,UAA0C,mBAAXC,QAAyBA,OAAOD,QAAUD,IAC9D,kBAAXG,SAAyBA,OAAOC,IAAMD,OAAOH,GACpDD,EAAOM,QAAQC,WAAWC,SAAWP,KACpCQ,KAAM,WAAc,YAErB,IAAIC,GAASC,EAAeC,EAAaC,EAAaC,EAAkBC,EAAkBC,EAAmBC,EAEzGC,EAAwC,SAAkBC,GAY7D,MAXAA,GAAKC,WAAY,EAEjBD,EAAKE,iBAAiB,YAAaP,GAAkB,GACrDK,EAAKE,iBAAiB,YAAaN,GAAkB,GACrDI,EAAKE,iBAAiB,YAAaL,GAAmB,GACtDG,EAAKE,iBAAiB,OAAQL,GAAmB,GAIjDG,EAAKE,iBAAiB,WAAYJ,GAAgB,IAGjDK,SAAU,WACTH,EAAKI,oBAAoB,YAAaT,GAAkB,GACxDK,EAAKI,oBAAoB,YAAaR,GAAkB,GACxDI,EAAKI,oBAAoB,YAAaP,GAAmB,GACzDG,EAAKI,oBAAoB,OAAQP,GAAmB,GACpDG,EAAKI,oBAAoB,WAAYN,GAAgB,KAKxDC,GAAsCM,YAAc,YAEpD,IAAIC,GAAe,kFAEnBX,GAAmB,SAAUY,GAC5B,GACIC,GADAC,EAAUnB,KAAKoB,QAQnB,IALAlB,EAAgBiB,EAAQE,QAAQC,IAGhCJ,EAAehB,EAAcqB,YAAY,KAEpB,KAAjBL,EACH,KAAM,IAAIM,OAAMR,EAMjB,IAHAb,EAAcD,EAAcuB,OAAO,EAAGP,GACtCd,GAAeF,EAAcwB,UAAUR,EAAe,GAElDS,MAAMvB,GACT,KAAM,IAAIoB,OAAMR,EAGjBC,GAAMW,aAAaC,QAAQ,OAAO,GAGlC5B,EAAUkB,EAAQW,MAGnBxB,EAAmB,WAClB,GAAIyB,GAAeb,EAAcc,EAAaC,EAAaC,EAAOC,CAGlE,IAAInC,KAAKoB,SAASU,OAAS7B,EAA3B,CASA,GALA8B,EAAgB/B,KAAKoB,SAASC,QAAQC,IAGtCJ,EAAea,EAAcR,YAAY,KAEpB,KAAjBL,EACH,KAAM,IAAIM,OAAMR,EAOjB,IAJAgB,EAAcD,EAAcN,OAAO,EAAGP,GACtCe,GAAeF,EAAcL,UAAUR,EAAe,GAGlDc,IAAgB7B,EAApB,CAKA,GAAI8B,IAAgB7B,EAEnB,WADAJ,MAAKoC,UAAUC,IAAI5B,EAAsCM,YAI1DmB,GAAQjC,EAAQqC,IAAInC,GAGpBgC,EAASD,EAAMK,OAAOnC,EAAa,GAAG,GAGtCA,EAAc6B,EAGdC,EAAMK,OAAOnC,EAAa,EAAG+B,MAG9B5B,EAAoB,WACnBP,KAAKoC,UAAUI,OAAO/B,EAAsCM,cAG7DP,EAAiB,SAAUS,GAC1BA,EAAMT,iBAGP,IAAIiC,GAA8BhC,CAElC,OAAOgC"}